---
title: 【学习记录】2022-9-26
mathjax: true
tags:
- 5G
- 核心网
categories:
- 通信技术
---

本周工作主要是看《SoftdEfined heteRogeneous VehICular nEtwork》以及弄清楚师兄让我搭的5G小系统。

<!-- more -->

## 5G核心网架构

在前面已经提到，5G核心网采用的是服务化架构，如图所示：

![image-20220926141829546](https://s2.loli.net/2022/09/27/ociUB37CxXeaYzF.png)

以前的网络是按层来划分的，是一种节点与节点、边与边的拓扑网络结构，关系错综复杂，集成度很高，共嗯大包大揽，入网简单，但是也有问题：首先扩展性差、升级困难，而且升级只能基于原本的硬件平台进行。



但是SBA架构没有这种问题，因为它拆分了网络功能（NF），这些网络功能通过接口介入到系统中，这样一来：

* 相同的网络功能一起承担和提供网络功能服务（NFS），负荷可以均衡分担。
* 任意的网络功能出现障碍，可以通过智能化的网络管理功能让他暂时退出服务，将其负责的业务转移到其他的正常的网络功能上处理。
* 扩展新的网络功能非常方便，调用接口就可以了。
* 升级很容易，软件和硬件都可以直接接入
* 网络开放，在标准接口下其他的系统也可以入网。

总的来说，SBA在核心网中就是对核心网进行改革，实现核心网软件化、灵活化、开放化和智慧化，**做到即插即用的效果。**

![image-20220926143041127](https://s2.loli.net/2022/09/27/LCl8MaBjpXFkcKY.png)



## 服务化架构关键技术点

服务化架构的主要技术要点又如下三点：

* 服务的提供通过生产者与消费者之间的信息交互达成。交互模式分成两种：Request-Response以及Subscrive-Notify，因为这样足够简单，所以在各类的网络功能（NF）之间接口交互很方便。

  * Request-Response：网络功能服务消费者`NF_A`向网络功能服务生产者`NF_B`请求特定的网络功能服务（服务内容可能是某种操作或者提供信息之类的），网络功能生产者根据请求的内容返回相应的服务结果。

    <center><img src="https://s2.loli.net/2022/09/27/wicEF3nIHYOUr1V.png" alt="image-20220926143901796" style="zoom: 25%;" />
        &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
        <img src="https://s2.loli.net/2022/09/27/g6iZfKh374VaG2S.png" alt="image-20220926143949780" style="zoom:25%;" /></center>

  * Subscribe-Notify：`NF_A`向`NF_B`订阅网络功能服务。`NF_B`对所有订阅服务的NF发送通知并返回结果。订阅的服务可能是按周期更新的信息或者特定事件的触发通知（某个东西到达了峰值、某个地方发生了改变）。

    <img src="https://s2.loli.net/2022/09/27/qm8ApOoStYaC1rU.png" alt="image-20220926144803196" style="zoom:25%;" />

* 实现了服务的自动化注册和发现。NF 通过服务化接口，将自身的能力作为一种服务暴露到网络中，并 被其他 NF 复用；NF 通过服务化接口的发现获取拥有所需 NF 服务的其它 NF 实例。这种注册和发现是通过 5G 核 心网引入的新型网络功能 NRF 来实现的： NRF 接收其它 NF 发来的服务注册信息，维护 NF 实例的相关信息和支 持的服务信息； NRF 接收其它 NF 发来的 NF 发现请求，返回对应的 NF 示例信息。

* 采用统一服务化接口协议。 R15 阶段在设计接口协议时，考虑了适应 IT 化、虚拟化、微服务化的需求， 目前定义的接口协议栈从下往上在传输层采用了 TCP，在应用层采用 HTTP/2.0 [3]，在序列化协议方面采用了 JSON， 接口描述语言采用 OpenAPI3.0， API 的设计方式采用 RESTFul。



## 架构调整

5G中的核心网主要有三个关键的逻辑节点：AMF、SMF和UPF。

![image-20220929092924527](https://s2.loli.net/2022/09/29/7gy6U18w2jLNfDp.png)

同时从另一个维度进行讨论的控制面（Control Pannel）和用户面（User Pannel）在5G也进行了重构：控制平面分成了AMF和SMF两个逻辑节点，AMF负责移动性相关的管理，SMF则负责会话管理；UPF替代了4G时代的服务网关SGW和PDN网关PGW，控制面功能集中了，与用户面进一步分离，这样大家都能灵活配置网络功能了。





## 关于AMF

**AMF是核心网的重中之重**，所有UE的接入靠的是他们与AMF之间的接口NG-RAN接口，再次声明下，不要把接口想象成一个四四方方的充电器插槽，在5G时代一切都要虚拟化（不能说百分百虚拟化，但至少是看不见的），都什么年代了，还在玩传统核心网？（bushi）



AMF的功能挺多的，这里加个`TODO`标签，以后提醒自己补一补。





## SoftdEfined heteRogeneous VehICular nEtwork

软件定义的车联异构网络。文章介绍了一个SOTA级别的框架，这个框架结合了异构网络的特点，同时也充分发挥了软件定义的框架的优势。整个网络架构分成三层：网络设施层（位于顶层）、控制层（位于中层）以及应用层（位于顶层）。

<img src="https://s2.loli.net/2022/09/28/S7jZtGRDOCr8MQh.png" alt="image-20220928150707187" style="zoom: 80%;" />

### 网络设施层

<img src="https://s2.loli.net/2022/09/28/PfrtkgBe1bja2ST.png" alt="image-20220928150824672" style="zoom:80%;" />

设施层主要是基础功能的集合，在SERVICE框架中设施主要分为三类，分别是通信设施、存储设施以及计算设施。这些设施在原文是这么给出的（图中左边中间的蜂窝区部分）：

![image-20220928152113627](https://s2.loli.net/2022/09/28/S8pzMnNeykGQxRj.png)

作者们对这个层的组件的称呼是“设施”，但是我们很容易先入为主的认为“设施”是某一类型的硬件设施，但在SERVICE这个软件定义网络的异构网络中，**“设施”应该理解成一种资源**，作者给出的样例中有计算资源、存储资源以及通信资源。其中计算资源以及存储资源又可以按照性能分成三种类型：微观云资源、本地云资源以及远程云资源。

这种资源的划分是合理的（通信资源为什么不在列，我的理解是通信在车辆行驶中的重要性是首要的，必须优先保障的，安全服务需要的资源是即时的，因此不能承受远程、云端的时效性风险），因为存储资源与计算资源的设立需要的设施（这次是真的硬件设施了，包括硬盘、算卡等资源）在路段很难部署，但是需求又不能不处理，而完全交给一个节点完成又会造成瘫痪，所以负载均衡是最好的选择。

### 控制层

<img src="https://s2.loli.net/2022/09/28/VfKHdp2MTi6SrP3.png" alt="image-20220928151313382" style="zoom: 28%;" />

控制层是一个层级结构，在一个服务区域（Service Area，一般认为设备的覆盖区域就是服务区域）中，由**主控制器**和**次控制器**构成的控制层对计算资源、通信资源以及存储资源进行分配。控制层由于其处于SERVICE结构的中层，因此它需要与上下层进行信息的流通与交互，交互的方式一共有三种：南向（控制层到网络设施层、应用层到控制层）交互、北向交互（控制层到应用层、网络设施层到控制层）。

![image-20220928151556984](https://s2.loli.net/2022/09/28/9rN3HPmvzWiS8AR.png)



值得一提的是，这个所谓的`控制器`其实**并不是真的是一个具体的器件**，因为在一个软件定义的网络框架中一切都可以软件化，所以**与其说“控制器”倒不如说“控制算法”或“控制软件”**。还有一点注意的是，控制层的控制对象是“通信控制”、“计算控制”和“存储控制”，这与网络设施层相呼应。

### 应用层

应用层高高在上，但是它主要是一般网络功能应用设计者用来存放、部署他们的成果的地方，前文提到，控制层位于网络架构的中层，所以应用层通过API与控制层交互，从而达到应用层控制一切的效果，但其实我们都知道真正在起作用的是控制层，应用层只是个指挥人干活的领导（抱歉，好像内涵了某些人）。作者给出的例子是接入管理和动态资源分配，本质上其实都是资源分配的过程问题。

## 虚拟化

前文提到网络设施层是资源的集合地，作者在后面干脆不装了，直接搬出了软件化的概念：把一切都虚拟化吧！把基站虚拟化，把计算资源虚拟化，把存储资源虚拟化......这不是我乱说，它真的是直接不装了把资源直接上云了。我们知道以往的通信设备比较垄断，要搞一套完整的通信系统很麻烦，几百万买个基站、天线以及配套的乱七八糟的东西才能搭建起来一个通信系统，但是到了5G时代，一切都软件化了：网元被拆成了网络功能，开放的接口、易于扩展的特点让大家都感叹真牛逼，所以SERVICE框架也想向这方面靠拢，因此在传统网络框架底层的部分原本应该陈列大件硬件设施的地方换成了几乎（话不能说太死）不占空间的虚拟资源。

![image-20220930111139061](https://s2.loli.net/2022/09/30/TgC1m76tD9E543O.png)



软件化一切是一种趋势，因为我们知道现在是个AI时代，你上大学没学过点人工智能或者机器学习都不好意思说你是工科生，我们知道人工智能最吃算力资源，算力资源的承载体——服务器有多大、多脆弱相信大家都知道了，所以资源虚拟化能很好迎合人工智能算法的部署（也方便我水论文^_^）。

### 虚拟化资源

前面提到SERVICE中存在多种资源（计算、通信、存储），然而在一个异构网络框架中还是要将他们标准化到一种特定的形式，才能方便后续的资源调度。SERVICE框架中的资源称为MDR（Multi Domain Resouce），他们存在MDRP（Multi Domain Resouce Pool）中。
